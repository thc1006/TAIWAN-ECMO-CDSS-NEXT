# Taiwan ECMO CDSS - Environment Configuration Template
# Copy this file to .env and update with your actual values

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL Connection
DB_HOST=localhost
DB_PORT=5432
DB_NAME=mimic4
DB_USER=ecmo_admin
DB_PASSWORD=your_secure_password_change_this

# Database schemas (comma-separated)
DB_SCHEMA=mimiciv_icu,mimiciv_hosp

# Connection pool settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# Environment (development, staging, production)
APP_ENV=production

# Debug mode (true/false) - NEVER use true in production!
DEBUG=false

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log directory
LOG_DIR=/var/log/ecmo-cdss

# Secret key for session encryption (generate with: openssl rand -hex 32)
SECRET_KEY=change_this_to_a_random_secret_key_generated_securely

# Flask secret key (for SMART app)
FLASK_SECRET_KEY=another_random_secret_key_for_flask

# ============================================================================
# SMART ON FHIR CONFIGURATION
# ============================================================================

# FHIR Server Base URL
# Examples:
# - SMART Health IT Sandbox: https://launch.smarthealthit.org/v/r4/fhir
# - Epic: https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4
# - Cerner: https://fhir-myrecord.cerner.com/r4/ec2458f2-1e24-41c8-b71b-0e701af7583d
FHIR_BASE_URL=https://launch.smarthealthit.org/v/r4/fhir

# SMART App Client ID (obtain from EHR vendor)
SMART_CLIENT_ID=your_client_id_here

# SMART App Client Secret (if using confidential client)
# Leave empty for public clients
SMART_CLIENT_SECRET=

# SMART App Redirect URI
# Must match the URI registered with EHR vendor
SMART_REDIRECT_URI=http://localhost:5000/callback

# Scopes (space-separated, don't change unless needed)
SMART_SCOPES=launch openid fhirUser patient/*.read

# ============================================================================
# TAIWAN NHI COST PARAMETERS (2025 estimates)
# ============================================================================

# Currency code
NHI_CURRENCY=TWD

# ICU costs (per day, in TWD)
NHI_ICU_COST_PER_DAY=30000

# Ward costs (per day, in TWD)
NHI_WARD_COST_PER_DAY=8000

# ECMO consumable costs (per day, in TWD)
NHI_ECMO_DAILY_CONSUMABLE=15000

# ECMO setup cost (one-time, in TWD)
NHI_ECMO_SETUP_COST=100000

# Staff costs (per day, in TWD)
NHI_ECMO_STAFF_COST_PER_DAY=20000

# Dialysis/CRRT cost (per day, in TWD)
NHI_CRRT_COST_PER_DAY=12000

# Blood product costs (per unit, in TWD)
NHI_PRBC_COST_PER_UNIT=3000
NHI_FFP_COST_PER_UNIT=2000
NHI_PLATELET_COST_PER_UNIT=5000

# ============================================================================
# COST-EFFECTIVENESS ANALYSIS PARAMETERS
# ============================================================================

# QALY gain per survivor (years)
QALY_GAIN_PER_SURVIVOR=1.5

# Time horizon (years)
TIME_HORIZON_YEARS=1.0

# Discount rate (0-1, e.g., 0.03 = 3%)
DISCOUNT_RATE=0.03

# Willingness-to-pay threshold (TWD per QALY)
# Taiwan GDP per capita ~900,000 TWD (1x), 2,700,000 TWD (3x)
WTP_THRESHOLD=1800000

# Monte Carlo simulation iterations
MC_ITERATIONS=1000

# ============================================================================
# MODEL CONFIGURATION
# ============================================================================

# Model directory
MODEL_DIR=/opt/ecmo-cdss/models

# Model version
MODEL_VERSION=1.0.0

# Risk threshold for high-risk classification (0-1)
RISK_THRESHOLD=0.5

# Model inference timeout (seconds)
MODEL_TIMEOUT=5

# Feature cache TTL (seconds)
FEATURE_CACHE_TTL=300

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/disable features (true/false)
ENABLE_NIRS_INTEGRATION=true
ENABLE_COST_ANALYSIS=true
ENABLE_VR_TRAINING=false
ENABLE_SMART_FHIR=true
ENABLE_AUTOMATED_REPORTS=true
ENABLE_REDIS_CACHE=false

# ============================================================================
# WEB SERVER CONFIGURATION
# ============================================================================

# Dashboard port
DASHBOARD_PORT=8501

# SMART app port
SMART_PORT=5000

# Nginx HTTP port
HTTP_PORT=80

# Nginx HTTPS port
HTTPS_PORT=443

# Redis port (if enabled)
REDIS_PORT=6379

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Enable HTTPS redirect (true/false)
FORCE_HTTPS=true

# Session timeout (minutes)
SESSION_TIMEOUT=60

# Max login attempts before lockout
MAX_LOGIN_ATTEMPTS=5

# Lockout duration (minutes)
LOCKOUT_DURATION=30

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,https://ecmo-cdss.hospital.org

# ============================================================================
# MONITORING AND LOGGING
# ============================================================================

# Enable performance monitoring (true/false)
ENABLE_MONITORING=true

# Enable audit logging (true/false)
ENABLE_AUDIT_LOG=true

# Log retention (days)
LOG_RETENTION_DAYS=90

# Sentry DSN (for error tracking, optional)
SENTRY_DSN=

# Prometheus metrics port (optional)
PROMETHEUS_PORT=9090

# ============================================================================
# EMAIL NOTIFICATIONS (Optional)
# ============================================================================

# SMTP server
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Email recipients for alerts (comma-separated)
ALERT_EMAIL=admin@hospital.org,ecmo-team@hospital.org

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================

# Backup directory
BACKUP_DIR=/backup/ecmo-cdss

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# S3 backup (optional)
AWS_S3_BUCKET=ecmo-cdss-backups
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=ap-northeast-1

# ============================================================================
# HOSPITAL-SPECIFIC SETTINGS
# ============================================================================

# Hospital identifier (for multi-tenant deployments)
HOSPITAL_ID=NTUH

# Hospital name
HOSPITAL_NAME=National Taiwan University Hospital

# Timezone
TZ=Asia/Taipei

# Language (zh-TW, en-US)
LANGUAGE=zh-TW

# ============================================================================
# DEVELOPMENT SETTINGS (Development only!)
# ============================================================================

# Reload on code changes (development only)
AUTO_RELOAD=false

# Enable SQL query logging (development only)
SQL_ECHO=false

# Enable Flask debug toolbar (development only)
FLASK_DEBUG_TOOLBAR=false

# Mock FHIR server (development only)
USE_MOCK_FHIR=false

# ============================================================================
# Never commit secrets to version control!
# Keep this file in your .gitignore
# ============================================================================